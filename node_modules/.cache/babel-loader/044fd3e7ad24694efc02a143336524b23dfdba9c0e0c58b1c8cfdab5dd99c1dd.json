{"ast":null,"code":"var _jsxFileName = \"D:\\\\D drive\\\\DDD\\\\NIKU\\\\nkprojects\\\\Major project hack\\\\ClientSync\\\\src\\\\components\\\\Notifications.js\",\n  _s = $RefreshSig$();\n// Notifications component placeholder\nimport React, { useState, useEffect } from \"react\";\nimport { collection, query, where, onSnapshot, orderBy, updateDoc, doc, getDocs, addDoc, deleteDoc } from \"firebase/firestore\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { auth, db } from \"../services/firebase\";\nimport emailjs from \"@emailjs/browser\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Notifications = () => {\n  _s();\n  const [user] = useAuthState(auth);\n  const [notifications, setNotifications] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [filter, setFilter] = useState(\"all\");\n  useEffect(() => {\n    if (!user) return;\n\n    // Listen for real-time notifications\n    const notificationsQuery = query(collection(db, \"notifications\"), where(\"userId\", \"==\", user.uid), orderBy(\"createdAt\", \"desc\"));\n    const unsubscribe = onSnapshot(notificationsQuery, snapshot => {\n      const notificationsList = snapshot.docs.map(doc => {\n        var _doc$data$createdAt;\n        return {\n          id: doc.id,\n          ...doc.data(),\n          createdAt: (_doc$data$createdAt = doc.data().createdAt) === null || _doc$data$createdAt === void 0 ? void 0 : _doc$data$createdAt.toDate()\n        };\n      });\n      setNotifications(notificationsList);\n      setLoading(false);\n    });\n\n    // Check for upcoming deadlines\n    checkUpcomingDeadlines();\n    return () => unsubscribe();\n  }, [user]);\n  const checkUpcomingDeadlines = async () => {\n    if (!user) return;\n    try {\n      const deliverablesQuery = query(collection(db, \"deliverables\"), where(\"clientId\", \"==\", user.uid), where(\"status\", \"!=\", \"Completed\"));\n      const snapshot = await getDocs(deliverablesQuery);\n      const now = new Date();\n      const twentyFourHours = 24 * 60 * 60 * 1000; // 24 hours in milliseconds\n\n      snapshot.docs.forEach(async deliverableDoc => {\n        const deliverable = deliverableDoc.data();\n        if (deliverable.deadline) {\n          const deadline = deliverable.deadline.toDate();\n          const timeDiff = deadline.getTime() - now.getTime();\n\n          // If deadline is within 24 hours and not already notified\n          if (timeDiff > 0 && timeDiff <= twentyFourHours && !deliverable.notificationSent) {\n            await createDeadlineNotification(deliverable, timeDiff);\n            await sendDeadlineEmail(deliverable, timeDiff);\n\n            // Mark as notified\n            await updateDoc(doc(db, \"deliverables\", deliverableDoc.id), {\n              notificationSent: true\n            });\n          }\n        }\n      });\n    } catch (error) {\n      console.error(\"Error checking deadlines:\", error);\n    }\n  };\n  const createDeadlineNotification = async (deliverable, timeDiff) => {\n    const hoursLeft = Math.floor(timeDiff / (1000 * 60 * 60));\n    const notificationData = {\n      userId: user.uid,\n      type: \"deadline\",\n      title: \"Upcoming Deadline\",\n      message: `\"${deliverable.title}\" is due in ${hoursLeft} hours`,\n      read: false,\n      priority: hoursLeft <= 2 ? \"High\" : \"Medium\",\n      createdAt: new Date(),\n      relatedId: deliverable.id,\n      relatedType: \"deliverable\"\n    };\n    try {\n      await addDoc(collection(db, \"notifications\"), notificationData);\n    } catch (error) {\n      console.error(\"Error creating notification:\", error);\n    }\n  };\n  const sendDeadlineEmail = async (deliverable, timeDiff) => {\n    const hoursLeft = Math.floor(timeDiff / (1000 * 60 * 60));\n    const templateParams = {\n      to_email: user.email,\n      // recipient\n      name: user.displayName || \"Client\",\n      // client name\n      deliverable_name: deliverable.title,\n      // deliverable name\n      due_date: deliverable.deadline.toDate().toLocaleString(),\n      // due date\n      dashboard_link: \"https://clientsync-77fd5.firebaseapp.com/dashboard\",\n      // update as needed\n      email: \"support@clientsync.com\" // reply-to (can be your support email or user's email)\n    };\n    try {\n      await emailjs.send(process.env.REACT_APP_EMAILJS_SERVICE_ID, process.env.REACT_APP_EMAILJS_DEADLINE_TEMPLATE_ID, templateParams, process.env.REACT_APP_EMAILJS_PUBLIC_KEY);\n      console.log(\"Deadline email sent successfully\");\n    } catch (error) {\n      console.error(\"Error sending deadline email:\", error);\n    }\n  };\n  const markAsRead = async notificationId => {\n    try {\n      await updateDoc(doc(db, \"notifications\", notificationId), {\n        read: true\n      });\n    } catch (error) {\n      console.error(\"Error marking notification as read:\", error);\n    }\n  };\n  const markAllAsRead = async () => {\n    const unreadNotifications = notifications.filter(n => !n.read);\n    try {\n      const promises = unreadNotifications.map(notification => updateDoc(doc(db, \"notifications\", notification.id), {\n        read: true\n      }));\n      await Promise.all(promises);\n    } catch (error) {\n      console.error(\"Error marking all notifications as read:\", error);\n    }\n  };\n  const deleteNotification = async notificationId => {\n    try {\n      await deleteDoc(doc(db, \"notifications\", notificationId));\n    } catch (error) {\n      console.error(\"Error deleting notification:\", error);\n    }\n  };\n  const getNotificationIcon = (type, priority) => {\n    const iconClass = priority === \"High\" ? \"text-red-500\" : priority === \"Medium\" ? \"text-yellow-500\" : \"text-blue-500\";\n    switch (type) {\n      case \"deadline\":\n        return /*#__PURE__*/_jsxDEV(\"svg\", {\n          className: `w-6 h-6 ${iconClass}`,\n          fill: \"none\",\n          stroke: \"currentColor\",\n          viewBox: \"0 0 24 24\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: 2,\n            d: \"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 11\n        }, this);\n      case \"update\":\n        return /*#__PURE__*/_jsxDEV(\"svg\", {\n          className: `w-6 h-6 ${iconClass}`,\n          fill: \"none\",\n          stroke: \"currentColor\",\n          viewBox: \"0 0 24 24\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: 2,\n            d: \"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this);\n      case \"ticket\":\n        return /*#__PURE__*/_jsxDEV(\"svg\", {\n          className: `w-6 h-6 ${iconClass}`,\n          fill: \"none\",\n          stroke: \"currentColor\",\n          viewBox: \"0 0 24 24\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: 2,\n            d: \"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 11\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(\"svg\", {\n          className: `w-6 h-6 ${iconClass}`,\n          fill: \"none\",\n          stroke: \"currentColor\",\n          viewBox: \"0 0 24 24\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: 2,\n            d: \"M15 17h5l-5 5v-5zM4 17v5h5M4 7V2h5M20 7V2h-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 229,\n          columnNumber: 11\n        }, this);\n    }\n  };\n  const filteredNotifications = notifications.filter(notification => {\n    if (filter === \"unread\") return !notification.read;\n    if (filter === \"read\") return notification.read;\n    return true; // 'all'\n  });\n  const unreadCount = notifications.filter(n => !n.read).length;\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-lg shadow-md p-6\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-pulse\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-6 bg-gray-200 rounded mb-4 w-1/3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-3\",\n          children: [1, 2, 3].map(i => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-12 h-12 bg-gray-200 rounded-full\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-4 bg-gray-200 rounded mb-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-3 bg-gray-200 rounded w-2/3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 265,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 17\n            }, this)]\n          }, i, true, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white rounded-lg shadow-md\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"px-6 py-4 border-b border-gray-200\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center mr-3\",\n            children: /*#__PURE__*/_jsxDEV(\"svg\", {\n              className: \"w-6 h-6 text-white\",\n              fill: \"none\",\n              stroke: \"currentColor\",\n              viewBox: \"0 0 24 24\",\n              children: /*#__PURE__*/_jsxDEV(\"path\", {\n                strokeLinecap: \"round\",\n                strokeLinejoin: \"round\",\n                strokeWidth: 2,\n                d: \"M15 17h5l-5 5v-5zM4 17v5h5M4 7V2h5M20 7V2h-5\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 288,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"text-2xl font-bold text-gray-800\",\n              children: \"Notifications\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 15\n            }, this), unreadCount > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-600\",\n              children: [unreadCount, \" unread notifications\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 301,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 11\n        }, this), unreadCount > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: markAllAsRead,\n          className: \"px-4 py-2 text-sm text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors\",\n          children: \"Mark all as read\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex space-x-1 mt-4\",\n        children: [{\n          key: \"all\",\n          label: \"All\",\n          count: notifications.length\n        }, {\n          key: \"unread\",\n          label: \"Unread\",\n          count: unreadCount\n        }, {\n          key: \"read\",\n          label: \"Read\",\n          count: notifications.length - unreadCount\n        }].map(tab => /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setFilter(tab.key),\n          className: `px-4 py-2 text-sm font-medium rounded-lg transition-colors ${filter === tab.key ? \"bg-blue-100 text-blue-700\" : \"text-gray-600 hover:text-gray-800 hover:bg-gray-50\"}`,\n          children: [tab.label, \" (\", tab.count, \")\"]\n        }, tab.key, true, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-h-96 overflow-y-auto\",\n      children: filteredNotifications.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-8 text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n          className: \"w-12 h-12 text-gray-300 mx-auto mb-4\",\n          fill: \"none\",\n          stroke: \"currentColor\",\n          viewBox: \"0 0 24 24\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: 2,\n            d: \"M15 17h5l-5 5v-5zM4 17v5h5M4 7V2h5M20 7V2h-5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-medium text-gray-900 mb-2\",\n          children: \"No notifications\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-500\",\n          children: filter === \"unread\" ? \"All caught up! No unread notifications.\" : \"You have no notifications at the moment.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"divide-y divide-gray-100\",\n        children: filteredNotifications.map(notification => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `p-4 hover:bg-gray-50 transition-colors ${!notification.read ? \"bg-blue-50 border-l-4 border-l-blue-500\" : \"\"}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-start space-x-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex-shrink-0 mt-1\",\n              children: getNotificationIcon(notification.type, notification.priority)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 382,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex-1 min-w-0\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between\",\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  className: `text-sm font-medium ${!notification.read ? \"text-gray-900\" : \"text-gray-700\"}`,\n                  children: notification.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 391,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center space-x-2 ml-4\",\n                  children: [notification.priority && /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${notification.priority === \"High\" ? \"bg-red-100 text-red-800\" : notification.priority === \"Medium\" ? \"bg-yellow-100 text-yellow-800\" : \"bg-blue-100 text-blue-800\"}`,\n                    children: notification.priority\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 400,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: () => deleteNotification(notification.id),\n                    className: \"text-gray-400 hover:text-gray-600 transition-colors\",\n                    title: \"Delete notification\",\n                    children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                      className: \"w-4 h-4\",\n                      fill: \"none\",\n                      stroke: \"currentColor\",\n                      viewBox: \"0 0 24 24\",\n                      children: /*#__PURE__*/_jsxDEV(\"path\", {\n                        strokeLinecap: \"round\",\n                        strokeLinejoin: \"round\",\n                        strokeWidth: 2,\n                        d: \"M6 18L18 6M6 6l12 12\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 423,\n                        columnNumber: 29\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 417,\n                      columnNumber: 27\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 412,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 398,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 390,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: `mt-1 text-sm ${!notification.read ? \"text-gray-800\" : \"text-gray-600\"}`,\n                children: notification.message\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 434,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 389,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 381,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-400 mt-2\",\n            children: notification.createdAt && notification.createdAt.toLocaleString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 443,\n            columnNumber: 17\n          }, this)]\n        }, notification.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 371,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 276,\n    columnNumber: 5\n  }, this);\n};\n_s(Notifications, \"Txd6E/kqIUrVHANBl+QSDFdPB7U=\", false, function () {\n  return [useAuthState];\n});\n_c = Notifications;\nexport default Notifications;\nvar _c;\n$RefreshReg$(_c, \"Notifications\");","map":{"version":3,"names":["React","useState","useEffect","collection","query","where","onSnapshot","orderBy","updateDoc","doc","getDocs","addDoc","deleteDoc","useAuthState","auth","db","emailjs","jsxDEV","_jsxDEV","Notifications","_s","user","notifications","setNotifications","loading","setLoading","filter","setFilter","notificationsQuery","uid","unsubscribe","snapshot","notificationsList","docs","map","_doc$data$createdAt","id","data","createdAt","toDate","checkUpcomingDeadlines","deliverablesQuery","now","Date","twentyFourHours","forEach","deliverableDoc","deliverable","deadline","timeDiff","getTime","notificationSent","createDeadlineNotification","sendDeadlineEmail","error","console","hoursLeft","Math","floor","notificationData","userId","type","title","message","read","priority","relatedId","relatedType","templateParams","to_email","email","name","displayName","deliverable_name","due_date","toLocaleString","dashboard_link","send","process","env","REACT_APP_EMAILJS_SERVICE_ID","REACT_APP_EMAILJS_DEADLINE_TEMPLATE_ID","REACT_APP_EMAILJS_PUBLIC_KEY","log","markAsRead","notificationId","markAllAsRead","unreadNotifications","n","promises","notification","Promise","all","deleteNotification","getNotificationIcon","iconClass","className","fill","stroke","viewBox","children","strokeLinecap","strokeLinejoin","strokeWidth","d","fileName","_jsxFileName","lineNumber","columnNumber","filteredNotifications","unreadCount","length","i","onClick","key","label","count","tab","_c","$RefreshReg$"],"sources":["D:/D drive/DDD/NIKU/nkprojects/Major project hack/ClientSync/src/components/Notifications.js"],"sourcesContent":["// Notifications component placeholder\r\nimport React, { useState, useEffect } from \"react\";\r\nimport {\r\n  collection,\r\n  query,\r\n  where,\r\n  onSnapshot,\r\n  orderBy,\r\n  updateDoc,\r\n  doc,\r\n  getDocs,\r\n  addDoc,\r\n  deleteDoc,\r\n} from \"firebase/firestore\";\r\nimport { useAuthState } from \"react-firebase-hooks/auth\";\r\nimport { auth, db } from \"../services/firebase\";\r\nimport emailjs from \"@emailjs/browser\";\r\n\r\nconst Notifications = () => {\r\n  const [user] = useAuthState(auth);\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [filter, setFilter] = useState(\"all\");\r\n\r\n  useEffect(() => {\r\n    if (!user) return;\r\n\r\n    // Listen for real-time notifications\r\n    const notificationsQuery = query(\r\n      collection(db, \"notifications\"),\r\n      where(\"userId\", \"==\", user.uid),\r\n      orderBy(\"createdAt\", \"desc\")\r\n    );\r\n\r\n    const unsubscribe = onSnapshot(notificationsQuery, (snapshot) => {\r\n      const notificationsList = snapshot.docs.map((doc) => ({\r\n        id: doc.id,\r\n        ...doc.data(),\r\n        createdAt: doc.data().createdAt?.toDate(),\r\n      }));\r\n      setNotifications(notificationsList);\r\n      setLoading(false);\r\n    });\r\n\r\n    // Check for upcoming deadlines\r\n    checkUpcomingDeadlines();\r\n\r\n    return () => unsubscribe();\r\n  }, [user]);\r\n\r\n  const checkUpcomingDeadlines = async () => {\r\n    if (!user) return;\r\n\r\n    try {\r\n      const deliverablesQuery = query(\r\n        collection(db, \"deliverables\"),\r\n        where(\"clientId\", \"==\", user.uid),\r\n        where(\"status\", \"!=\", \"Completed\")\r\n      );\r\n\r\n      const snapshot = await getDocs(deliverablesQuery);\r\n      const now = new Date();\r\n      const twentyFourHours = 24 * 60 * 60 * 1000; // 24 hours in milliseconds\r\n\r\n      snapshot.docs.forEach(async (deliverableDoc) => {\r\n        const deliverable = deliverableDoc.data();\r\n        if (deliverable.deadline) {\r\n          const deadline = deliverable.deadline.toDate();\r\n          const timeDiff = deadline.getTime() - now.getTime();\r\n\r\n          // If deadline is within 24 hours and not already notified\r\n          if (\r\n            timeDiff > 0 &&\r\n            timeDiff <= twentyFourHours &&\r\n            !deliverable.notificationSent\r\n          ) {\r\n            await createDeadlineNotification(deliverable, timeDiff);\r\n            await sendDeadlineEmail(deliverable, timeDiff);\r\n\r\n            // Mark as notified\r\n            await updateDoc(doc(db, \"deliverables\", deliverableDoc.id), {\r\n              notificationSent: true,\r\n            });\r\n          }\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error checking deadlines:\", error);\r\n    }\r\n  };\r\n\r\n  const createDeadlineNotification = async (deliverable, timeDiff) => {\r\n    const hoursLeft = Math.floor(timeDiff / (1000 * 60 * 60));\r\n\r\n    const notificationData = {\r\n      userId: user.uid,\r\n      type: \"deadline\",\r\n      title: \"Upcoming Deadline\",\r\n      message: `\"${deliverable.title}\" is due in ${hoursLeft} hours`,\r\n      read: false,\r\n      priority: hoursLeft <= 2 ? \"High\" : \"Medium\",\r\n      createdAt: new Date(),\r\n      relatedId: deliverable.id,\r\n      relatedType: \"deliverable\",\r\n    };\r\n\r\n    try {\r\n      await addDoc(collection(db, \"notifications\"), notificationData);\r\n    } catch (error) {\r\n      console.error(\"Error creating notification:\", error);\r\n    }\r\n  };\r\n\r\n  const sendDeadlineEmail = async (deliverable, timeDiff) => {\r\n    const hoursLeft = Math.floor(timeDiff / (1000 * 60 * 60));\r\n\r\n    const templateParams = {\r\n      to_email: user.email, // recipient\r\n      name: user.displayName || \"Client\", // client name\r\n      deliverable_name: deliverable.title, // deliverable name\r\n      due_date: deliverable.deadline.toDate().toLocaleString(), // due date\r\n      dashboard_link: \"https://clientsync-77fd5.firebaseapp.com/dashboard\", // update as needed\r\n      email: \"support@clientsync.com\", // reply-to (can be your support email or user's email)\r\n    };\r\n\r\n    try {\r\n      await emailjs.send(\r\n        process.env.REACT_APP_EMAILJS_SERVICE_ID,\r\n        process.env.REACT_APP_EMAILJS_DEADLINE_TEMPLATE_ID,\r\n        templateParams,\r\n        process.env.REACT_APP_EMAILJS_PUBLIC_KEY\r\n      );\r\n      console.log(\"Deadline email sent successfully\");\r\n    } catch (error) {\r\n      console.error(\"Error sending deadline email:\", error);\r\n    }\r\n  };\r\n\r\n  const markAsRead = async (notificationId) => {\r\n    try {\r\n      await updateDoc(doc(db, \"notifications\", notificationId), {\r\n        read: true,\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error marking notification as read:\", error);\r\n    }\r\n  };\r\n\r\n  const markAllAsRead = async () => {\r\n    const unreadNotifications = notifications.filter((n) => !n.read);\r\n\r\n    try {\r\n      const promises = unreadNotifications.map((notification) =>\r\n        updateDoc(doc(db, \"notifications\", notification.id), { read: true })\r\n      );\r\n      await Promise.all(promises);\r\n    } catch (error) {\r\n      console.error(\"Error marking all notifications as read:\", error);\r\n    }\r\n  };\r\n\r\n  const deleteNotification = async (notificationId) => {\r\n    try {\r\n      await deleteDoc(doc(db, \"notifications\", notificationId));\r\n    } catch (error) {\r\n      console.error(\"Error deleting notification:\", error);\r\n    }\r\n  };\r\n\r\n  const getNotificationIcon = (type, priority) => {\r\n    const iconClass =\r\n      priority === \"High\"\r\n        ? \"text-red-500\"\r\n        : priority === \"Medium\"\r\n        ? \"text-yellow-500\"\r\n        : \"text-blue-500\";\r\n\r\n    switch (type) {\r\n      case \"deadline\":\r\n        return (\r\n          <svg\r\n            className={`w-6 h-6 ${iconClass}`}\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n            />\r\n          </svg>\r\n        );\r\n      case \"update\":\r\n        return (\r\n          <svg\r\n            className={`w-6 h-6 ${iconClass}`}\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\r\n            />\r\n          </svg>\r\n        );\r\n      case \"ticket\":\r\n        return (\r\n          <svg\r\n            className={`w-6 h-6 ${iconClass}`}\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z\"\r\n            />\r\n          </svg>\r\n        );\r\n      default:\r\n        return (\r\n          <svg\r\n            className={`w-6 h-6 ${iconClass}`}\r\n            fill=\"none\"\r\n            stroke=\"currentColor\"\r\n            viewBox=\"0 0 24 24\"\r\n          >\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth={2}\r\n              d=\"M15 17h5l-5 5v-5zM4 17v5h5M4 7V2h5M20 7V2h-5\"\r\n            />\r\n          </svg>\r\n        );\r\n    }\r\n  };\r\n\r\n  const filteredNotifications = notifications.filter((notification) => {\r\n    if (filter === \"unread\") return !notification.read;\r\n    if (filter === \"read\") return notification.read;\r\n    return true; // 'all'\r\n  });\r\n\r\n  const unreadCount = notifications.filter((n) => !n.read).length;\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"bg-white rounded-lg shadow-md p-6\">\r\n        <div className=\"animate-pulse\">\r\n          <div className=\"h-6 bg-gray-200 rounded mb-4 w-1/3\"></div>\r\n          <div className=\"space-y-3\">\r\n            {[1, 2, 3].map((i) => (\r\n              <div key={i} className=\"flex items-center space-x-4\">\r\n                <div className=\"w-12 h-12 bg-gray-200 rounded-full\"></div>\r\n                <div className=\"flex-1\">\r\n                  <div className=\"h-4 bg-gray-200 rounded mb-2\"></div>\r\n                  <div className=\"h-3 bg-gray-200 rounded w-2/3\"></div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-md\">\r\n      {/* Header */}\r\n      <div className=\"px-6 py-4 border-b border-gray-200\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center mr-3\">\r\n              <svg\r\n                className=\"w-6 h-6 text-white\"\r\n                fill=\"none\"\r\n                stroke=\"currentColor\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M15 17h5l-5 5v-5zM4 17v5h5M4 7V2h5M20 7V2h-5\"\r\n                />\r\n              </svg>\r\n            </div>\r\n            <div>\r\n              <h2 className=\"text-2xl font-bold text-gray-800\">\r\n                Notifications\r\n              </h2>\r\n              {unreadCount > 0 && (\r\n                <p className=\"text-sm text-gray-600\">\r\n                  {unreadCount} unread notifications\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {unreadCount > 0 && (\r\n            <button\r\n              onClick={markAllAsRead}\r\n              className=\"px-4 py-2 text-sm text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors\"\r\n            >\r\n              Mark all as read\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Filter Tabs */}\r\n        <div className=\"flex space-x-1 mt-4\">\r\n          {[\r\n            { key: \"all\", label: \"All\", count: notifications.length },\r\n            { key: \"unread\", label: \"Unread\", count: unreadCount },\r\n            {\r\n              key: \"read\",\r\n              label: \"Read\",\r\n              count: notifications.length - unreadCount,\r\n            },\r\n          ].map((tab) => (\r\n            <button\r\n              key={tab.key}\r\n              onClick={() => setFilter(tab.key)}\r\n              className={`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${\r\n                filter === tab.key\r\n                  ? \"bg-blue-100 text-blue-700\"\r\n                  : \"text-gray-600 hover:text-gray-800 hover:bg-gray-50\"\r\n              }`}\r\n            >\r\n              {tab.label} ({tab.count})\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Notifications List */}\r\n      <div className=\"max-h-96 overflow-y-auto\">\r\n        {filteredNotifications.length === 0 ? (\r\n          <div className=\"p-8 text-center\">\r\n            <svg\r\n              className=\"w-12 h-12 text-gray-300 mx-auto mb-4\"\r\n              fill=\"none\"\r\n              stroke=\"currentColor\"\r\n              viewBox=\"0 0 24 24\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M15 17h5l-5 5v-5zM4 17v5h5M4 7V2h5M20 7V2h-5\"\r\n              />\r\n            </svg>\r\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n              No notifications\r\n            </h3>\r\n            <p className=\"text-gray-500\">\r\n              {filter === \"unread\"\r\n                ? \"All caught up! No unread notifications.\"\r\n                : \"You have no notifications at the moment.\"}\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"divide-y divide-gray-100\">\r\n            {filteredNotifications.map((notification) => (\r\n              <div\r\n                key={notification.id}\r\n                className={`p-4 hover:bg-gray-50 transition-colors ${\r\n                  !notification.read\r\n                    ? \"bg-blue-50 border-l-4 border-l-blue-500\"\r\n                    : \"\"\r\n                }`}\r\n              >\r\n                <div className=\"flex items-start space-x-3\">\r\n                  <div className=\"flex-shrink-0 mt-1\">\r\n                    {getNotificationIcon(\r\n                      notification.type,\r\n                      notification.priority\r\n                    )}\r\n                  </div>\r\n\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <h4\r\n                        className={`text-sm font-medium ${\r\n                          !notification.read ? \"text-gray-900\" : \"text-gray-700\"\r\n                        }`}\r\n                      >\r\n                        {notification.title}\r\n                      </h4>\r\n                      <div className=\"flex items-center space-x-2 ml-4\">\r\n                        {notification.priority && (\r\n                          <span\r\n                            className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${\r\n                              notification.priority === \"High\"\r\n                                ? \"bg-red-100 text-red-800\"\r\n                                : notification.priority === \"Medium\"\r\n                                ? \"bg-yellow-100 text-yellow-800\"\r\n                                : \"bg-blue-100 text-blue-800\"\r\n                            }`}\r\n                          >\r\n                            {notification.priority}\r\n                          </span>\r\n                        )}\r\n                        <button\r\n                          onClick={() => deleteNotification(notification.id)}\r\n                          className=\"text-gray-400 hover:text-gray-600 transition-colors\"\r\n                          title=\"Delete notification\"\r\n                        >\r\n                          <svg\r\n                            className=\"w-4 h-4\"\r\n                            fill=\"none\"\r\n                            stroke=\"currentColor\"\r\n                            viewBox=\"0 0 24 24\"\r\n                          >\r\n                            <path\r\n                              strokeLinecap=\"round\"\r\n                              strokeLinejoin=\"round\"\r\n                              strokeWidth={2}\r\n                              d=\"M6 18L18 6M6 6l12 12\"\r\n                            />\r\n                          </svg>\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <p\r\n                      className={`mt-1 text-sm ${\r\n                        !notification.read ? \"text-gray-800\" : \"text-gray-600\"\r\n                      }`}\r\n                    >\r\n                      {notification.message}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n                <div className=\"text-xs text-gray-400 mt-2\">\r\n                  {notification.createdAt &&\r\n                    notification.createdAt.toLocaleString()}\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Notifications;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}